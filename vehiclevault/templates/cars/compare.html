{% extends 'base.html' %}
{% block title %}Compare Vehicles | Vehicle Vault{% endblock %}
{% load static %}
{% block content %}

<div class="dashboard-container">
    <div class="section-header">
        <div class="badge bg-primary-subtle text-primary mb-3"
            style="border-radius: 20px; padding: 8px 20px; font-weight: 600; letter-spacing: 1px;">SIDE-BY-SIDE ANALYSIS
        </div>
        <h2 class="text-white">Vehicle Comparison</h2>
        <p style="color: var(--text-muted);">Technical specifications and performance metrics comparison.</p>
    </div>

    {% if cars|length >= 2 %}
    <div class="comparison-grid row g-4 mb-5">
        {% for car in cars %}
        <div class="col-md-6">
            <div class="car-card p-0" style="background: transparent; border: none;">
                <div class="img-container rounded-4 mb-4" style="height: 300px;">
                    <img src="{% if car.car_image %}{{ car.car_image.url }}{% else %}{% static 'images/logo.png' %}{% endif %}"
                        alt="{{ car.brand }}" class="w-100 h-100 object-fit-cover rounded-4">
                    <a href="{% url 'cars:remove_from_compare' car.id %}"
                        class="btn-close btn-close-white position-absolute top-0 end-0 m-3 p-2 bg-dark rounded-circle"
                        style="opacity: 0.8;"></a>
                </div>
                <div class="text-center">
                    <h3 class="display-6 fw-bold mb-1 text-white">{{ car.brand }}</h3>
                    <p class="text-accent fs-4 fw-light">{{ car.model }} ({{ car.launch_year }})</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="comparison-table-wrapper shadow-lg overflow-hidden"
        style="background: var(--bg-card); border-radius: 32px; border: 1px solid var(--glass-border);">
        <table class="table table-dark table-borderless mb-0">
            <thead>
                <tr style="background: rgba(15, 23, 42, 0.9); border-bottom: 2px solid var(--glass-border);">
                    <th class="ps-5 py-4 text-muted small letter-spacing-1">SPECIFICATION</th>
                    {% for car in cars %}
                    <th class="py-4 text-center">{{ car.brand }} {{ car.model }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody class="comparison-body">
                <tr>
                    <td class="ps-5 py-4 fw-600 text-muted">Price</td>
                    {% for car in cars %}
                    <td class="text-center py-4 fw-800 text-accent">₹{{ car.price }}</td>
                    {% endfor %}
                </tr>
                <tr style="background: rgba(255,255,255,0.02);">
                    <td class="ps-5 py-4 fw-600 text-muted">Fuel Type</td>
                    {% for car in cars %}
                    <td class="text-center py-4">{{ car.fuel_type }}</td>
                    {% endfor %}
                </tr>
                <tr>
                    <td class="ps-5 py-4 fw-600 text-muted">Mileage</td>
                    {% for car in cars %}
                    <td class="text-center py-4">{{ car.mileage }} km/l</td>
                    {% endfor %}
                </tr>
                <tr style="background: rgba(255,255,255,0.02);">
                    <td class="ps-5 py-4 fw-600 text-muted">Launch Year</td>
                    {% for car in cars %}
                    <td class="text-center py-4">{{ car.launch_year }}</td>
                    {% endfor %}
                </tr>
                <tr>
                    <td class="ps-5 py-4 fw-600 text-muted">Status</td>
                    {% for car in cars %}
                    <td class="text-center py-4">
                        {% if car.stock > 0 %}
                        <span class="text-success fw-bold">Available</span>
                        {% else %}
                        <span class="text-danger fw-bold">Out of Stock</span>
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr style="background: rgba(25, 135, 84, 0.05);">
                    <td class="ps-5 py-4 fw-600 text-muted">Action</td>
                    {% for car in cars %}
                    <td class="text-center py-4 px-5">
                        <a href="{% url 'cars:car_detail' car.vin %}" class="card-btn py-2">Full Details</a>
                    </td>
                    {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>

    {% else %}
    <div class="text-center py-5">
        <div class="fs-1 mb-4">⚖️</div>
        <h3 class="text-white">Comparison List Empty</h3>
        <p style="color: var(--text-muted);" class="mb-4">Select at least two vehicles to see a detailed side-by-side
            analysis.</p>
        <a href="{% url 'cars:all_cars' %}" class="login-btn text-decoration-none">Browse Inventory</a>
    </div>
    {% endif %}
</div>

<style>
    .comparison-body td {
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        font-size: 1.1rem;
    }

    .letter-spacing-1 {
        letter-spacing: 2px;
    }
</style>

{% endblock %}